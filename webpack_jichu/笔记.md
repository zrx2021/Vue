# 学习笔记

## webpack介绍
1. 概念：webpack是前端项目工程化的具体解决方案
2. 主要功能：
    - 它提供了友好的模块化开发支持
    - 代码压缩混淆
    - 处理浏览器段JavaScrpt的兼容性，如let定义变量时，IE浏览器不兼容，但可以被转换成var
    - 性能优化
    - 其它强大的功能。
3. 好处：把工作重心转移到具体功能实现上，提高了前端开发效率和项目的可维护性。
4. 注意： 目前vue，React等前端项目，基本上都是基于webpack进行工程化开发的。

---

## webpack的作用，什么是工程化？
- 模块化 - js的模块化、css的模块化、资源的模块化；

- 组件化 - 复用现有的UI结构、样式、行为；

- 规范化 - 目录结构的划分、编码规范化、接口规范化、文档规划化、Git分支管理；

- 自动化 - 自动化构建、自动部署、自动化测试

---

## 在项目中安装 webpack
```bash
npm install webpack@5.42.1 webpack-cli@4.7.2 -D
# @ 符号用于指定版本号
# -D 用于写入包，将会写在 package.json 中的 devDependencies 节点
# 部分
```

---

## package.json 中 devDependencies 与 Dependencies 区别
- devDependencies是开发环境，Dependencies 是 开发环境 和 线上环境
- 在命令行终端中参数 -D 代表开发环境，是 --save-dev 的简写
- 在命令行终端中参数 -S 代表线上环境，是 --save 的简写

### 如何确定包要安装到哪个环境？

可以在[npm](http://npmjs.com)的官网中查看搜索

例如安装 `webpack`，命令中有提示安装的环境：
```bash
#Install with npm:

npm install --save-dev webpack
```

---

## 在项目中配置 webpack
1. 在项目根目录中，创建名为`webpack.config.js`的webpack配置文件，并初始化如下的基本配置：
```js
//在node中向外导出一个配置对象，供webpack使用
    module.exports={
        mode: 'development'//mode 用来指定构建模式，可选的值有 development 和 production，分别代表开发环境和发布上线环境
    }
```
2. 在 `package.json`的json节点下，新增dev脚本如下：
```js
"script": {
    "dev": "webpack"//script 节点下的脚本，可以通过 npm run 执行。如npm run dev，意为运行名为 dev 的脚本，在脚本中名字可以是任意合法的英文名。webpack是执行的命令
}
```
3. 在终端中运行`npm run dev`命令，启动webpack进行项目的打包构建
4. 运行后会生成`main.js`，默认在`dist`目录下。`main.js`会包含`index.js`及其引入的JavaScript代码

---

## `webpack.config.js`中`module.exports mode`可选值的应用场景
- development 开发环境，没有进行代码压缩，打包时间快。
- production 线上环境，有对代码进行压缩混淆，打包时间变长，**注释消失**。

---

## 当执行`npm run dev`时（也就是打包构建之前），会运行`dev`脚本会先读取`webpack.config.js`配置文件，获取到运行模式后，基于配置对项目进行打包

---

## `webpack 4.x`和`webpack 5.x`的版本中有如下默认规定：
1. 默认的打包入口文件为`src -> index.js`
    - 当无法找到`index.js`时会导致报错
2. 默认的输出文件路径为`dist -> main.js`
3. 可以在`webpack.config.js`中修改打包的默认约定

---

## 在`webpack.config.js`配置文件中，通过`entry`节点指定`打包的入口`。通过`output`节点指定`打包的出口`代码如下：
```js
//导入node.js中专门操作路径的模块，用require导入
const path = require('path')

//__dirname代表当前文件的存放路径
module.exports = {
    //打包入口文件的路径
    entry: path.join(__dirname, './src/index.js'),
    //输出文件的存放路径
    output: {
        path: path.join(__dirname, './dist'),
        //输出文件的名称
        filename: 'bundle.js'
    }
}
```

---

## 每当修改代码，就要重新打包，可以安装webpack插件进行自动打包。最常用的有如下两个：
1. `webpack-dev-server`:
    - 类似于node.js用到的 nodemon 工具
    - 每当修改了源代码，webpack 会自动进行项目的打包和构建
    - 运行如下命令，在项目中安装此插件（开发环境）：
    ```bash
    npm install webpack-dev-server@3.11.2 -D
    ``` 

2. `html-webpack-plugin`:
    - webpack 中的 HTML 插件（类似于一个模板引擎插件）
    - 可以通过此插件自定义 index.html 页面的内容
    - 运行如下的命令，即可在项目中安装此插件：
    ```bash
    npm install html-webpack-plugin@5.3.2 -D
    ```
---

## 配置webpack-dev-server

1. 修改`package.json -> scripts`中的`dev`命令如下：
```js
"script": {
    //script 节点下的脚本，可以通过npm run执行
    "dev": "webpack serve"
}
```
2. 再次运行`npm run dev`命令，重新进行项目的打包
3. 在浏览器中访问`http://localhost:8080`地址，插件自动打包效果

注意：
- webpack-dev-server会启动一个`实时打包的http服务器`
- 需要访问`http://localhost:8080`才能看到效果
- 输出的js文件会在网址的根目录，没有在磁盘上，资源管理器无法找到，在内存中。
- 修改代码保存后，会自动刷新浏览器。

---

##配置html-webpack-plugin，在`webpack.config.js`中

```js
//1. 导入插件，得到一个构造函数
const HtmlPlugin = require('html-webpack-plugin')

//2. 创建 HTML 插件的实例对象
const htmlPlugin = new HtmlPlugin({
    //指定源文件的存放路径
    template: './src/index',
    //指定生成的文件的存放路径
    filename: ./index.html,
})

module.exports = {
    name: 'development',
    //通过 plugins 节点，使htmlPlugin 插件生效
    plugins: [htmlPlugin],
}
```

---

## html-webpack-plugin插件的特性
- 可以把复制的html文件放到内存里 
- 在复制出来的、内存里的`index.html`自动添加内存中的js脚本到`<head>`标签内。也就是说自动注入了打包的`main.js`文件，再也无需手动修改页面的引入脚本。